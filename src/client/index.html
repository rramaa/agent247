<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Agent 24-7</title>
    <script>
      function initMap() {
        window.myDirectionsService = new google.maps.DirectionsService;
        window.myDirectionsDisplay = new google.maps.DirectionsRenderer;
        var map = new google.maps.Map(document.getElementById('map'), {
          zoom: 15,
          scrollwheel: false,
          navigationControl: false,
          mapTypeControl: false,
          scaleControl: false,
          draggable: false,
          center: {lat: 28.4439267, lng: 77.10113164}
        });
        myDirectionsDisplay.setMap(map);
      	calculateAndDisplayRoute();
      }

      function calculateAndDisplayRoute() {
      	var origin = window.origin,
      		desination = window.destination,
      		waypoints = window.waypoints,
      		directionsService =  window.myDirectionsService,
      		directionsDisplay = window.myDirectionsDisplay,

      		tempDest='',
      		tempWayPts=[],
      		currWayPt=-1;

      		looperPromise = function() {
				return new Promise((resolve, reject)=>{
					if(tempDest != '') tempWayPts.push({location:tempDest, stopover:true});

					if(currWayPt < waypoints.length-1){
						tempDest = waypoints[++currWayPt].location;
					} else if (currWayPt == waypoints.length-1) {
						currWayPt++;
						tempDest = desination;
					} else {
						return reject('Finished Routing');
					}

					directionsService.route({
					  origin: origin,
					  destination: tempDest,
					  waypoints: tempWayPts,
					  optimizeWaypoints: true,
					  travelMode: 'DRIVING'
					}, function(response, status) {
					  if (status === 'OK') {
					    directionsDisplay.setDirections(response);
					    return resolve();
					    var route = response.routes[0];
					  } else {
					    window.alert('Directions request failed due to ' + status);
					    return reject();
					  }
					});
				});
      		},

      		looper = function (){
      			looperPromise().then(()=>{setTimeout(looper,2000)});
      		};

      		setTimeout(looper,1000);
      }
    </script>
    <title>React App</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  </head>
  <body>
  	<div id="root"></div>
  </body>
</html>